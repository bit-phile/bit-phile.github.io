<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Introduction to Docker Compose | bitPhile</title><meta name=keywords content="docker,docker-compose,docker compose,compose,services,management,orchestration"><meta name=description content="Hello people! Good to see you here. Today we would be learning about docker compose, what is it, why we need it, and its examples. Let&rsquo;s begin.
Agenda Current Scenario What is docker-compose? How does docker compose change the current scenario? Defining Services Volume and Bind mounts Networking Environment Variables Conclusion Current Scenario A single application comprises containers for different services responsible for their respective tasks. For example, a backend service, a database service to manage data, a frontend for the app, and so on."><meta name=author content="Nitin"><link rel=canonical href=https://bit-phile.github.io/tech/docker/docker-compose/><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bit-phile.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bit-phile.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bit-phile.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://bit-phile.github.io/apple-touch-icon.png><link rel=mask-icon href=https://bit-phile.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Introduction to Docker Compose"><meta property="og:description" content="Hello people! Good to see you here. Today we would be learning about docker compose, what is it, why we need it, and its examples. Let&rsquo;s begin.
Agenda Current Scenario What is docker-compose? How does docker compose change the current scenario? Defining Services Volume and Bind mounts Networking Environment Variables Conclusion Current Scenario A single application comprises containers for different services responsible for their respective tasks. For example, a backend service, a database service to manage data, a frontend for the app, and so on."><meta property="og:type" content="article"><meta property="og:url" content="https://bit-phile.github.io/tech/docker/docker-compose/"><meta property="article:section" content="tech"><meta property="article:published_time" content="2023-03-26T08:59:38+05:30"><meta property="article:modified_time" content="2023-03-26T08:59:38+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Introduction to Docker Compose"><meta name=twitter:description content="Hello people! Good to see you here. Today we would be learning about docker compose, what is it, why we need it, and its examples. Let&rsquo;s begin.
Agenda Current Scenario What is docker-compose? How does docker compose change the current scenario? Defining Services Volume and Bind mounts Networking Environment Variables Conclusion Current Scenario A single application comprises containers for different services responsible for their respective tasks. For example, a backend service, a database service to manage data, a frontend for the app, and so on."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Teches","item":"https://bit-phile.github.io/tech/"},{"@type":"ListItem","position":2,"name":"Introduction to Docker Compose","item":"https://bit-phile.github.io/tech/docker/docker-compose/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Introduction to Docker Compose","name":"Introduction to Docker Compose","description":"Hello people! Good to see you here. Today we would be learning about docker compose, what is it, why we need it, and its examples. Let\u0026rsquo;s begin.\nAgenda Current Scenario What is docker-compose? How does docker compose change the current scenario? Defining Services Volume and Bind mounts Networking Environment Variables Conclusion Current Scenario A single application comprises containers for different services responsible for their respective tasks. For example, a backend service, a database service to manage data, a frontend for the app, and so on.","keywords":["docker","docker-compose","docker compose","compose","services","management","orchestration"],"articleBody":" Hello people! Good to see you here. Today we would be learning about docker compose, what is it, why we need it, and its examples. Let’s begin.\nAgenda Current Scenario What is docker-compose? How does docker compose change the current scenario? Defining Services Volume and Bind mounts Networking Environment Variables Conclusion Current Scenario A single application comprises containers for different services responsible for their respective tasks. For example, a backend service, a database service to manage data, a frontend for the app, and so on. All of these services need to be in the same network to communicate with each other. I have explained docker networking in my post Docker Networking.\nManaging all these services and different constituents such as networking, volumes, bind mounts, etc becomes an arduous task.\nThe following points summarise the problems in the current scenario:\nNetworking. We have to explicitly create and manage networks. We have to be sure that a particular container is connected to a particular network. Volumes and bind mounts. There is no centralized way to know what all volumes are connected to all services of an application. Container lifecycle. If any container stops, it becomes our responsibility to restart the container. These are some of the major problems. Setting up a multi-container application comprises multiple commands. For example,\n# for running database container docker run -d --name database --network bitphile images/mysql # for running frontend docker run -d --name frontend -p 3001:3001 --network bitphile bitphile/frontend # for running backend docker run -d --name backend --network bitphile -mount type=volume,source=bitphile,target=/vol bitphile/backend This is just for a small multi-container application comprising three services. Think about if the application is composing several services.\nDocker Compose Docker compose is a tool that helps in defining and running multi-container applications. It enables us to define each container as a service, its interactions with other services, and some other configurations.\nHow does it help to tackle the current Scenario? Let’s see each of the points mentioned in the problem statement and scrutinize how docker compose helps in there.\nNetworking Services defined inside a docker compose for a particular application are by default in a network for that project. When the docker compose is up, all those services are in a project namespace network.\nSo, there is no need to worry if the frontend sends a request to the backend. Moreover, the networking properties still apply here. A container can be referenced with its name for sending a request instead of its IP address.\nWe will this into action shortly in a subsequent section.\nVolumes and bind mounts We can define volumes and bind mounts for services inside the docker compose definition file. We can specify to delete the volumes when doing compose down.\nContainers Life Cycle Docker compose acts like an orchestrator which manages the life cycle of containers. Though it is not much effective for small applications it suffices. It provides ways to specify restart the container if it dies.\nIt becomes very easy to create, run and stop services by using docker compose.\nWhole application picture in a single place Using docker compose, the application becomes fathomable. By seeing the docker compose file itself we can identify what is happening. What all services are there, what is the networking structure, what volumes are in use, etc.\nWell, it is all about theory. Let’s see docker compose in action.\nDefining services We are required to create a docker compose file named docker-compose.yml (you can give any other name but have to specify explicitly in the command, we will see shortly).\nA minimal docker compose file looks like following\nversion: '3.7' name: bitphile services: todo-backend: container_name: todo-backend image: bitphile/todo-backend Explanation version defines the version of Compose file. It is required to identify the schema used for the docker compose file. name is the name of the project. If it is omitted, the project directory name is assigned to name. services defines what all containers the compose comprises. Each item is the name of the service. Building image There are two ways we can define service.\nSpecifying how docker can build an image by giving build property. Directly giving the image. version: '3.7' name: bitphile services: todo-backend: container_name: todo-backend build: dockerfile: Dockerfile context: . This builds the image and spins up the container.\nDirectly using image version: '3.7' name: bitphile services: todo-backend: container_name: todo-backend image: node-alpine This will lead to pulling off the image and then spinning up the container.\nVolume and Bind mounts It is fairly simple to mount a volume in docker compose. There are following ways a docker volume can be mounted.\nLet docker create volume for you version: '3.7' name: bitphile services: todo-backend: container_name: todo-backend image: bitphile/todo-backend volumes: - /app/volume Now, if we spin up the compose\n⟩ docker compose up -d and listing down the volumes, we get\n⟩ docker volume ls DRIVER VOLUME NAME local a98a19a6d84da93031cb6a331993d2a49bfde5689594a413caddefe4a84d4aef So, docker itself created a volume for you.\nNamed Volume We can name our volume by explicitly specifying volumes section in compose file.\nversion: '3.7' name: bitphile services: todo-backend: container_name: todo-backend image: bitphile/todo-backend volumes: - bitphile:/app/volume volumes: bitphile: driver: local volumes can have more properties. You can check those out on the official docs of docker (I have mentioned them in the references section).\nBind a host path We can bind a host path as follows\nversion: '3.7' name: bitphile services: todo-backend: container_name: todo-backend image: bitphile/todo-backend volumes: - ./host/path:/app/host Note: The structure of the volumes item is, [source:]target[:mode] where mode can be ro (read only) and rw (read and write).\nNetworking Docker compose by default creates a default network where all the defined services reside. However, we can explicitly create a network and define the services.\nversion: '3.7' name: bitphile services: todo-backend: container_name: todo-backend image: bitphile/todo-backend network: - bitphile networks: bitphile: driver: bridge We don’t need to mention driver properties. Docker uses it as default. Just to mention that we can specify more properties, I have specified this property.\nEnvironment Variables You must be already aware of environment variables and their use cases. We can use environment variables in docker compose in the following ways.\nPassing to services Using environment Using env_file Environment variables version: '3.7' name: bitphile services: todo-backend: container_name: todo-backend image: bitphile/todo-backend environment: - NODE_ENV=production Environment file version: '3.7' name: bitphile services: todo-backend: container_name: todo-backend image: bitphile/todo-backend env_file: - .env-file Populating Environment variables in compose file Passing environment file through docker compose command Using .env file Passing through CLI Docker provides --env-file flag to specify the environment file to use.\n⟩ docker compose --env-file .env-file up Using .env We don’t need to specify this file. Docker takes it by default.\nConclusion So, docker compose is a powerful tool helping in creating and managing multi containers applications. It provides several features and options which can’t be covered in this post. If you are interested in deep diving into those features, I would recommend you to go through the official docs. For simple uses, I don’t think you would have to rummage through all those options.\nSo, this is it for now. We have reached our junction and our train has to take a halt. Let’s continue our journey on the next green light with some other interesting topic.\nPlease provide your valuable feedback about what you liked, what has to improve, and what topic should be there for our next junction.\nUntil then,\nReferences Docker compose overview Docker CLI reference Docker compose file ","wordCount":"1236","inLanguage":"en","datePublished":"2023-03-26T08:59:38+05:30","dateModified":"2023-03-26T08:59:38+05:30","author":{"@type":"Person","name":"Nitin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bit-phile.github.io/tech/docker/docker-compose/"},"publisher":{"@type":"Organization","name":"bitPhile","logo":{"@type":"ImageObject","url":"https://bit-phile.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bit-phile.github.io/ accesskey=h title="bitPhile (Alt + H)">bitPhile</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Introduction to Docker Compose</h1><div class=post-meta><span title='2023-03-26 08:59:38 +0530 +0530'>March 26, 2023</span>&nbsp;·&nbsp;Nitin</div></header><div class=post-content><p><img loading=lazy src=/tech/docker/docker-compose-banner.png alt="Docker Compose Banner" title="Docker Compose Banner"></p><p>Hello people! Good to see you here. Today we would be learning about docker compose, what is it, why we need it, and its examples. Let&rsquo;s begin.</p><h2 id=agenda>Agenda<a hidden class=anchor aria-hidden=true href=#agenda>#</a></h2><ol><li>Current Scenario</li><li>What is docker-compose?</li><li>How does docker compose change the current scenario?</li><li>Defining Services</li><li>Volume and Bind mounts</li><li>Networking</li><li>Environment Variables</li><li>Conclusion</li></ol><h2 id=current-scenario>Current Scenario<a hidden class=anchor aria-hidden=true href=#current-scenario>#</a></h2><p>A single application comprises containers for different services responsible for their respective tasks. For example, a backend service, a database service to manage data, a frontend for the app, and so on. All of these services need to be in the same network to communicate with each other. I have explained docker networking in my post <a href=/tech/docker/docker-networking>Docker Networking</a>.</p><p>Managing all these services and different constituents such as networking, volumes, bind mounts, etc becomes an arduous task.</p><p><img loading=lazy src=/tech/docker/prior-docker-compose.png alt="Before docker compose" title="A person having difficulties managing docker containers"></p><p>The following points summarise the problems in the current scenario:</p><ol><li>Networking. We have to explicitly create and manage networks. We have to be sure that a particular container is connected to a particular network.</li><li>Volumes and bind mounts. There is no centralized way to know what all volumes are connected to all services of an application.</li><li>Container lifecycle. If any container stops, it becomes our responsibility to restart the container.</li></ol><p>These are some of the major problems. Setting up a multi-container application comprises multiple commands. For example,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e># for running database container</span>
</span></span><span style=display:flex><span>docker run -d --name database --network bitphile images/mysql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># for running frontend</span>
</span></span><span style=display:flex><span>docker run -d --name frontend -p 3001:3001 --network bitphile bitphile/frontend
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># for running backend</span>
</span></span><span style=display:flex><span>docker run -d --name backend --network bitphile -mount type<span style=color:#f92672>=</span>volume,source<span style=color:#f92672>=</span>bitphile,target<span style=color:#f92672>=</span>/vol bitphile/backend
</span></span></code></pre></div><p>This is just for a small multi-container application comprising three services. Think about if the application is composing several services.</p><h2 id=docker-compose>Docker Compose<a hidden class=anchor aria-hidden=true href=#docker-compose>#</a></h2><p>Docker compose is a tool that helps in defining and running multi-container applications. It enables us to define each container as a service, its interactions with other services, and some other configurations.</p><h2 id=how-does-it-help-to-tackle-the-current-scenario>How does it help to tackle the current Scenario?<a hidden class=anchor aria-hidden=true href=#how-does-it-help-to-tackle-the-current-scenario>#</a></h2><p>Let&rsquo;s see each of the points mentioned in the problem statement and scrutinize how docker compose helps in there.</p><h3 id=networking>Networking<a hidden class=anchor aria-hidden=true href=#networking>#</a></h3><p>Services defined inside a docker compose for a particular application are by default in a network for that project. When the docker compose is up, all those services are in a project namespace network.</p><p>So, there is no need to worry if the frontend sends a request to the backend. Moreover, the networking properties still apply here. A container can be referenced with its name for sending a request instead of its IP address.</p><p>We will this into action shortly in a subsequent section.</p><h3 id=volumes-and-bind-mounts>Volumes and bind mounts<a hidden class=anchor aria-hidden=true href=#volumes-and-bind-mounts>#</a></h3><p>We can define volumes and bind mounts for services inside the docker compose definition file. We can specify to delete the volumes when doing compose down.</p><h3 id=containers-life-cycle>Containers Life Cycle<a hidden class=anchor aria-hidden=true href=#containers-life-cycle>#</a></h3><p>Docker compose acts like an orchestrator which manages the life cycle of containers. Though it is not much effective for small applications it suffices. It provides ways to specify restart the container if it dies.</p><p>It becomes very easy to create, run and stop services by using docker compose.</p><h3 id=whole-application-picture-in-a-single-place>Whole application picture in a single place<a hidden class=anchor aria-hidden=true href=#whole-application-picture-in-a-single-place>#</a></h3><p>Using docker compose, the application becomes fathomable. By seeing the docker compose file itself we can identify what is happening. What all services are there, what is the networking structure, what volumes are in use, etc.</p><p>Well, it is all about theory. Let&rsquo;s see docker compose in action.</p><h2 id=defining-services>Defining services<a hidden class=anchor aria-hidden=true href=#defining-services>#</a></h2><p>We are required to create a docker compose file named <code>docker-compose.yml</code> (you can give any other name but have to specify explicitly in the command, we will see shortly).</p><p>A minimal docker compose file looks like following</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.7&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>todo-backend</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>bitphile/todo-backend</span>
</span></span></code></pre></div><h3 id=explanation>Explanation<a hidden class=anchor aria-hidden=true href=#explanation>#</a></h3><ol><li><code>version</code> defines the version of Compose file. It is required to identify the schema used for the docker compose file.</li><li><code>name</code> is the name of the project. If it is omitted, the project directory name is assigned to <code>name</code>.</li><li><code>services</code> defines what all containers the compose comprises. Each item is the name of the service.</li></ol><h3 id=building-image>Building image<a hidden class=anchor aria-hidden=true href=#building-image>#</a></h3><p>There are two ways we can define service.</p><ol><li>Specifying how docker can build an image by giving <code>build</code> property.</li><li>Directly giving the <code>image</code>.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.7&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>todo-backend</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>	    <span style=color:#f92672>dockerfile</span>: <span style=color:#ae81ff>Dockerfile</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>context</span>: <span style=color:#ae81ff>.</span>
</span></span></code></pre></div><p>This builds the image and spins up the container.</p><h3 id=directly-using-image>Directly using image<a hidden class=anchor aria-hidden=true href=#directly-using-image>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.7&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>todo-backend</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>node-alpine</span>
</span></span></code></pre></div><p>This will lead to pulling off the image and then spinning up the container.</p><h2 id=volume-and-bind-mounts>Volume and Bind mounts<a hidden class=anchor aria-hidden=true href=#volume-and-bind-mounts>#</a></h2><p>It is fairly simple to mount a volume in docker compose. There are following ways a docker volume can be mounted.</p><h3 id=let-docker-create-volume-for-you>Let docker create volume for you<a hidden class=anchor aria-hidden=true href=#let-docker-create-volume-for-you>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.7&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>todo-backend</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>bitphile/todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>	    - <span style=color:#ae81ff>/app/volume</span>
</span></span></code></pre></div><p>Now, if we spin up the compose</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>⟩ docker compose up -d
</span></span></code></pre></div><p>and listing down the volumes, we get</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>⟩ docker volume ls                                                           
</span></span><span style=display:flex><span>DRIVER    VOLUME NAME
</span></span><span style=display:flex><span>local     a98a19a6d84da93031cb6a331993d2a49bfde5689594a413caddefe4a84d4aef
</span></span></code></pre></div><p>So, docker itself created a volume for you.</p><h3 id=named-volume>Named Volume<a hidden class=anchor aria-hidden=true href=#named-volume>#</a></h3><p>We can name our volume by explicitly specifying <code>volumes</code> section in compose file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.7&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>todo-backend</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>bitphile/todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>	    - <span style=color:#ae81ff>bitphile:/app/volume</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>	<span style=color:#f92672>bitphile</span>:
</span></span><span style=display:flex><span>		<span style=color:#f92672>driver</span>: <span style=color:#ae81ff>local</span>
</span></span></code></pre></div><p><code>volumes</code> can have more properties. You can check those out on the official docs of docker (I have mentioned them in the references section).</p><h3 id=bind-a-host-path>Bind a host path<a hidden class=anchor aria-hidden=true href=#bind-a-host-path>#</a></h3><p>We can bind a host path as follows</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.7&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>todo-backend</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>bitphile/todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>	    - <span style=color:#ae81ff>./host/path:/app/host</span>
</span></span></code></pre></div><blockquote><p>Note: The structure of the volumes item is, <code>[source:]target[:mode]</code> where mode can be <code>ro</code> (read only) and <code>rw</code> (read and write).</p></blockquote><h2 id=networking-1>Networking<a hidden class=anchor aria-hidden=true href=#networking-1>#</a></h2><p>Docker compose by default creates a default network where all the defined services reside. However, we can explicitly create a network and define the services.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.7&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>todo-backend</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>bitphile/todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>network</span>:
</span></span><span style=display:flex><span>	    - <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>networks</span>:
</span></span><span style=display:flex><span>	<span style=color:#f92672>bitphile</span>:
</span></span><span style=display:flex><span>		<span style=color:#f92672>driver</span>: <span style=color:#ae81ff>bridge</span>
</span></span></code></pre></div><p>We don&rsquo;t need to mention <code>driver</code> properties. Docker uses it as default. Just to mention that we can specify more properties, I have specified this property.</p><h2 id=environment-variables>Environment Variables<a hidden class=anchor aria-hidden=true href=#environment-variables>#</a></h2><p>You must be already aware of environment variables and their use cases. We can use environment variables in docker compose in the following ways.</p><h3 id=passing-to-services>Passing to services<a hidden class=anchor aria-hidden=true href=#passing-to-services>#</a></h3><ol><li>Using <code>environment</code></li><li>Using <code>env_file</code></li></ol><h4 id=environment-variables-1>Environment variables<a hidden class=anchor aria-hidden=true href=#environment-variables-1>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.7&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>todo-backend</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>bitphile/todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>	    - <span style=color:#ae81ff>NODE_ENV=production</span>
</span></span></code></pre></div><h4 id=environment-file>Environment file<a hidden class=anchor aria-hidden=true href=#environment-file>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3.7&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>bitphile</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>todo-backend</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>bitphile/todo-backend</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>env_file</span>: 
</span></span><span style=display:flex><span>     - <span style=color:#ae81ff>.env-file</span>
</span></span></code></pre></div><h3 id=populating-environment-variables-in-compose-file>Populating Environment variables in compose file<a hidden class=anchor aria-hidden=true href=#populating-environment-variables-in-compose-file>#</a></h3><ol><li>Passing environment file through docker compose command</li><li>Using <code>.env</code> file</li></ol><h4 id=passing-through-cli>Passing through CLI<a hidden class=anchor aria-hidden=true href=#passing-through-cli>#</a></h4><p>Docker provides <code>--env-file</code> flag to specify the environment file to use.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>⟩ docker compose --env-file .env-file up
</span></span></code></pre></div><h4 id=using-env>Using <code>.env</code><a hidden class=anchor aria-hidden=true href=#using-env>#</a></h4><p>We don&rsquo;t need to specify this file. Docker takes it by default.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>So, docker compose is a powerful tool helping in creating and managing multi containers applications. It provides several features and options which can&rsquo;t be covered in this post. If you are interested in deep diving into those features, I would recommend you to go through the official docs. For simple uses, I don&rsquo;t think you would have to rummage through all those options.</p><p>So, this is it for now. We have reached our junction and our train has to take a halt. Let&rsquo;s continue our journey on the next green light with some other interesting topic.</p><p>Please provide your valuable feedback about what you liked, what has to improve, and what topic should be there for our next junction.</p><p>Until then,</p><p><img loading=lazy src=/bye-mr-bean.gif alt="Bye by Mr Bean" title="Bye bye, see you on next post"></p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ol><li><a href=https://docs.docker.com/compose/>Docker compose overview</a></li><li><a href=https://docs.docker.com/compose/reference/>Docker CLI reference</a></li><li><a href=https://docs.docker.com/compose/compose-file/compose-file-v3/>Docker compose file</a></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://bit-phile.github.io/tags/docker/>docker</a></li><li><a href=https://bit-phile.github.io/tags/docker-compose/>docker-compose</a></li><li><a href=https://bit-phile.github.io/tags/compose/>compose</a></li><li><a href=https://bit-phile.github.io/tags/services/>services</a></li><li><a href=https://bit-phile.github.io/tags/management/>management</a></li><li><a href=https://bit-phile.github.io/tags/orchestration/>orchestration</a></li></ul></footer><div id=commentor></div><script>const embedCommentorJs=()=>new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("defer",!0),n.src="/commentor/commentor.js",n.onload=e,n.onerror=t,document.head.appendChild(n)}),embedCommentorStyles=()=>new Promise((e,t)=>{const n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.href="/commentor/commentor.css",n.onload=e,n.onerror=t,document.head.appendChild(n)}),getPageId=()=>window.location.href.split("/").slice(-2).join("");embedCommentorJs().then(()=>embedCommentorStyles()).then(()=>{Commentor&&Commentor.init("Comments",getPageId())}).catch(e=>console.error("Commentor not loaded",e))</script></article></main><footer class=footer><span>&copy; 2023 <a href=https://bit-phile.github.io/>bitPhile</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>