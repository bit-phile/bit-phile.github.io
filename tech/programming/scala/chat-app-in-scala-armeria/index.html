<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Chat App in Scala Armeria | bitPhile</title>
<meta name=keywords content="rest-api,microservices,armeria,websocket,socket"><meta name=description content="Contents

Abstract
What is Armeria and its features?
Project details
Project setup requirements
Setting up Armeria and service handler
Setting up the web socket handler
Show example in the browser console
Socket service for frontend
Code snippet of the chat screen
Working example Screenshots etc
Conclusion
Acknowledgements
References

Abstract
As a part of E4R (Engineering for Research) retreat Hackathon, we explored Armeria and created a small PoC single group chat application using HTTP request polling and websockets. We are using the Armeria framework to develop one of the services in our project. So, it became the inspiration for the exploration."><meta name=author content="Nitin"><link rel=canonical href=https://nitinsharmacs.github.io/tech/programming/scala/chat-app-in-scala-armeria/><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://nitinsharmacs.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nitinsharmacs.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://nitinsharmacs.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://nitinsharmacs.github.io/apple-touch-icon.png><link rel=mask-icon href=https://nitinsharmacs.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://nitinsharmacs.github.io/tech/programming/scala/chat-app-in-scala-armeria/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=gJLtPY-9n93JySFcqJqqBbytVUMKY7nTN5ZTvTmOfjY"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","gJLtPY-9n93JySFcqJqqBbytVUMKY7nTN5ZTvTmOfjY")}</script><meta property="og:title" content="Chat App in Scala Armeria"><meta property="og:description" content="Contents

Abstract
What is Armeria and its features?
Project details
Project setup requirements
Setting up Armeria and service handler
Setting up the web socket handler
Show example in the browser console
Socket service for frontend
Code snippet of the chat screen
Working example Screenshots etc
Conclusion
Acknowledgements
References

Abstract
As a part of E4R (Engineering for Research) retreat Hackathon, we explored Armeria and created a small PoC single group chat application using HTTP request polling and websockets. We are using the Armeria framework to develop one of the services in our project. So, it became the inspiration for the exploration."><meta property="og:type" content="article"><meta property="og:url" content="https://nitinsharmacs.github.io/tech/programming/scala/chat-app-in-scala-armeria/"><meta property="article:section" content="tech"><meta property="article:published_time" content="2023-08-15T13:49:50+05:30"><meta property="article:modified_time" content="2023-08-15T13:49:50+05:30"><meta name=twitter:card content="summary"><meta name=twitter:title content="Chat App in Scala Armeria"><meta name=twitter:description content="Contents

Abstract
What is Armeria and its features?
Project details
Project setup requirements
Setting up Armeria and service handler
Setting up the web socket handler
Show example in the browser console
Socket service for frontend
Code snippet of the chat screen
Working example Screenshots etc
Conclusion
Acknowledgements
References

Abstract
As a part of E4R (Engineering for Research) retreat Hackathon, we explored Armeria and created a small PoC single group chat application using HTTP request polling and websockets. We are using the Armeria framework to develop one of the services in our project. So, it became the inspiration for the exploration."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Teches","item":"https://nitinsharmacs.github.io/tech/"},{"@type":"ListItem","position":2,"name":"Chat App in Scala Armeria","item":"https://nitinsharmacs.github.io/tech/programming/scala/chat-app-in-scala-armeria/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Chat App in Scala Armeria","name":"Chat App in Scala Armeria","description":"Contents Abstract What is Armeria and its features? Project details Project setup requirements Setting up Armeria and service handler Setting up the web socket handler Show example in the browser console Socket service for frontend Code snippet of the chat screen Working example Screenshots etc Conclusion Acknowledgements References Abstract As a part of E4R (Engineering for Research) retreat Hackathon, we explored Armeria and created a small PoC single group chat application using HTTP request polling and websockets. We are using the Armeria framework to develop one of the services in our project. So, it became the inspiration for the exploration.\n","keywords":["rest-api","microservices","armeria","websocket","socket"],"articleBody":"Contents Abstract What is Armeria and its features? Project details Project setup requirements Setting up Armeria and service handler Setting up the web socket handler Show example in the browser console Socket service for frontend Code snippet of the chat screen Working example Screenshots etc Conclusion Acknowledgements References Abstract As a part of E4R (Engineering for Research) retreat Hackathon, we explored Armeria and created a small PoC single group chat application using HTTP request polling and websockets. We are using the Armeria framework to develop one of the services in our project. So, it became the inspiration for the exploration.\nThis blog constitutes building a small chat application using REST API framework Armeria, Scala, and JavaScript. It won‚Äôt have end-to-end code but only contains code snippets. You can find code on here.\nWhat is Armeria? Armeria is a REST API microservice framework that becomes a backbone of powerful, fast, and asynchronous web services. It is completely asynchronous and built on top of reactive streams and Java 8 CompletableFuture. It is built in Java and compatible with any language that runs on JVM such as Scala, Kotlin, Clojure, etc.\nIt lets you develop services with technologies like gRPC, Thrift, HTTP, etc. running on the same application and port.\nI think this introduction to Armeria would be enough to get a basic understanding. If you are more interested in Armeria‚Äôs features, please have a look at its official website. Now let‚Äôs see Armeria in action with the help of a small chat application.\nAbout PoC We are going to build a single group chat application comprising a backend service in Scala using the Armeria framework and a frontend service using React/Javascript.\nPrerequisites To get started with the project, we have to have some required prerequisites.\nJava 17 or more installed Scala installed and sbt Node v17 or more And an IDE of your choice. Setting up the project Assuming all the prerequisites done, create a new project using sbt.\nmkdir chat-app cd chat-app sbt It setups the project. Now we need to create build.sbt and write the following inside it.\nThisBuild / version := \"0.1.0-SNAPSHOT\" ThisBuild / scalaVersion := \"3.3.0\" lazy val root = (project in file(\".\")) .settings( name := \"chat-app-retreat\", libraryDependencies ++= Seq( \"com.linecorp.armeria\" %% \"armeria-scala\" % \"1.24.2\", \"com.linecorp.armeria\" % \"armeria-logback\" % \"1.24.2\", \"com.lihaoyi\" %% \"upickle\" % \"3.0.0\" ) ) Create src directory with the following basic structure.\nsrc ‚îú‚îÄ‚îÄ main ‚îÇ¬†‚îú‚îÄ‚îÄ resources ‚îÇ¬†‚îî‚îÄ‚îÄ scala ‚îî‚îÄ‚îÄ test ‚îî‚îÄ‚îÄ scala Now reload the project using sbt reload.\nCreate a service handler in Main.scala Creating a simple server in Armeria is very simple as below code snippet shows. For now, we only have a single handler on path \"/\" that responds with OK.\nobject Main: def main(args: Array[String]): Unit = val port: Int = 8000 val server: Server = newServer(port) val future = server.start() future.join() logger.info(s\"Server is running on port $port\") private def newServer(port: Int) = val serverBuilder: ServerBuilder = Server.builder() serverBuilder .http(port) .service( \"/\", (ctx, req) =\u003e HttpResponse.of(HttpStatus.OK) ) .requestTimeout(Duration.ofSeconds(1000)) .build() A handler or a service is attached to the server using service method. We can also have an annotated controller similar to Spring Boot that can be attached using annotatedService method.\nRunning this and sending request to our server, we get 200 OK. Cool, our server works.\n‚ü© curl http://localhost:8000/ 200 OK‚èé Creating message endpoints We require to create two endpoints for creating and fetching all the messages.\nGET /e4r/message POST /e4r/create-message Supposing we have a ChatController which handlers messages services. Adding it to server would like as shown below.\nprivate def newServer(port: Int) = val serverBuilder: ServerBuilder = Server.builder() serverBuilder .http(port) .service( \"/\", (ctx, req) =\u003e HttpResponse.of(HttpStatus.OK) ) .annotatedService( \"/e4r\", ChatController(ChatService(new ChatRepository)) ) .requestTimeout(Duration.ofSeconds(1000)) .build() Adding two handlers in ChatController\nclass ChatController(chatService: ChatService): @Get(\"/message\") def getMessages: HttpResponse = val result = chatService.getMessages HttpResponse.ofJson(HttpStatus.OK, messages) @Post(\"/create-message\") @RequestConverter(classOf[JacksonRequestConverterFunction]) def createMessage(message: MessageDTO): HttpResponse = chatService .createMessage(message.toMessage) HttpResponse.of(HttpStatus.CREATED) Sending request on /e4r/message returns all the messages in group. /e4r/create-message creates a new message.\n‚ü© curl -X POST --header \"content-type: application/json\" -d '{\"sender\":\"@atul\", \"text\": \"Hey there!\", \"createdAt\": \"2023-08-03T09:30:37.258Z\"}' http://localhost:8000/e4r/create-message 201 Created ‚ü© curl -q http://localhost:8000/e4r/message | jq [ { \"id\": \"d69f836c-eac7-48dc-9138-9d2d40b38f4c\", \"sender\": \"@atul\", \"text\": \"Hey there!\", \"createdAt\": 1692114770.973873 }, { \"id\": \"50ca044a-0f2b-4904-902f-297946c30413\", \"sender\": \"@atul\", \"text\": \"Hey there!\", \"createdAt\": 1691055037.258 } ] Implementing Websocket handler To make the chat experiment real-time, we are required to use web sockets. Web socket is a protocol that creates a full duplex connection among devices. Want to deep dive into web sockets? You can have a read about it over this.\nTalking about Armeria, it has got web socket support in recent versions and that‚Äôs why there is no rich documentation on it. However, we managed to get some implementation of web sockets by going through the code and tests.\nLet‚Äôs attach a socket service to our server.\nval socketService = new SocketService() socketService.on(\"new-message\", (data) =\u003e println(data)) socketService.on { (data) =\u003e println(\"from broadcast\") println(data) } private def newServer(port: Int) = val serverBuilder: ServerBuilder = Server.builder() serverBuilder .http(port) .service( \"/\", (ctx, req) =\u003e HttpResponse.of(HttpStatus.OK) ) .service( \"/chat/:clientId\", WebSocketService.builder(socketService).allowedOrigins(\"*\").build() ) .annotatedService( \"/e4r\", ChatController(ChatService(new ChatRepository)) ) .requestTimeout(Duration.ofSeconds(1000)) .build() WebSocketService builder takes socketService and builds a websocket handler. Method allowOrigins let‚Äôs it accept connection from any origin.\nFollowing code snippet shows SocketService.\nclass SocketService extends WebSocketServiceHandler: override def handle(ctx: ServiceRequestContext, in: WebSocket): WebSocket = val writer: WebSocketWriter = WebSocket.streaming() in.subscribe(new Subscriber[WebSocketFrame]: def onSubscribe(s: Subscription): Unit = s.request(Long.MaxValue) def onNext(webSocketFrame: WebSocketFrame): Unit = try val frame = webSocketFrame try frame.`type` match case WebSocketFrameType.TEXT =\u003e // call handlers getAllHanders.foreach((cb) =\u003e cb(frame.text())) case WebSocketFrameType.CLOSE =\u003e val closeFrame = frame.asInstanceOf[CloseWebSocketFrame] writer.close(closeFrame.status, closeFrame.reasonPhrase) case _ =\u003e // do nothing catch case jsonException: ujson.ParseException =\u003e println(jsonException) case t: Throwable =\u003e writer.close(t) finally println(\"finally\") catch case t: Throwable =\u003e println(t) def onError(t: Throwable): Unit = writer.close(t) def onComplete(): Unit = println(\"CLOSED\") writer.close ) writer def emit(namespace: String, data: String): Unit = this.socketWriters.values.foreach((writer) =\u003e writer.write(this.createPayload(namespace, data, \"namespaced\")) ) SocketService extends WebSocketServiceHandler. The important method to implement is handle which triggers every time any client connects with the server.\nArmeria implements Websocket using reactive streams. So, a subscriber is attached to the web socket reactive stream in on every new connection. The writer stream is used to write data to the connected client socket.\nwriter.write(\"Hello world\") emit is the method that takes a namespace and data. Any handler on the client side listening on this namespace will get that data.\nSo, whenever a new message is created, all the connected clients have to be notified about the message. This can be accomplished using,\nclass ChatController(chatService: ChatService, socket: SocketService): // ... @Post(\"/create-message\") @RequestConverter(classOf[JacksonRequestConverterFunction]) def createMessage(message: MessageDTO): HttpResponse = socket.emit(\"new-message\", message.toJson) chatService .createMessage(message.toMessage) HttpResponse.of(HttpStatus.CREATED) new-message is namespace and message.toJson is data.\nLet‚Äôs try creating a message and see if we get new message on client socket.\nSo, the client is connected to the server. Creating a new message triggers a message event on client socket. The below picture shows the message it got from the server.\nOur simple chat application (without any UI üòÇ) is working.\nImplementing Socket on UI Similar to backend, we have written a wrapper on top of WebSocket. This simplistic wrapper manages namespaces and invokes handlers listening on respective namespaces.\ntype fn = { (data: string): void }; class ChatSocket { handlers: { [key: string]: fn[] }; //... connect() { this.socket = new WebSocket(this.url + `/${this.username}`); this.socket.addEventListener('open', () =\u003e { console.log('socket connected'); }); this.socket.addEventListener('message', (event: MessageEvent) =\u003e { const { namespace, data } = JSON.parse(event.data); this.handlers[namespace].forEach((cb) =\u003e cb(data)); }); this.socket.addEventListener('close', (event) =\u003e console.log('Closed', event) ); return this; } //... } To register a handler, wrapper implements an on method.\nclass ChatSocket { //... on(namespace: string, cb: fn): void { const handlers = this.handlers[namespace]; if (handlers) { handlers.push(cb); return; } this.handlers[namespace] = [cb]; } Using Socket wrapper in Chat component As of now, we are only listening on new messages. We are not sending messages using socket. Messages are created using HTTP REST request only.\nFollowing shows usages of socket wrapper in a chat component.\nconst Chats = ({ chatService, username }: ChatAppProps) =\u003e { //... useEffect(() =\u003e { //... const chatSocket = new ChatSocket( 'ws://localhost:8000/chat', username ).connect(); chatSocket.on('new-message', (message: Message) =\u003e setMessages((prevMessages: Message[]) =\u003e [...prevMessages, message]) ); }, []); //... }; useEffect hook initialises the socket and socket starts listening on new-message namespace. Whenever a new message comes, setMessages updates the messages state and the component updates.\nConclusion Armeria is a newly developed framework which is currently in development. It provides several powerful features such as allowing to run different services within a single application and on the same port. It also provides asynchronous execution out of the box. So, it can handle multiple requests without us implementing concurrency and get our hands dirty in threads and concurrency. If you are looking for a lightweight, fast, asynchronous, and ready-to-use REST API framework, it is a good choice to go with.\nHowever, being a new framework, the documentation is undeveloped. We tried to find the implementation of web sockets by going inside the tests they‚Äôve created.\nAcknowledgements We would like to thank Satya and the Retreat team for organising such an interesting Retreat. Thanks to all the team members (Shubham Chauhan and Atul) who have chosen this trivial problem statement to explore.\nReferences Armeria Official Docs. URL: https://armeria.dev/docs/ Armeria Github Repo. URL: https://github.com/line/armeria Trustin Lee ‚Äî Armeria: A microservice framework well-suited everywhere. Youtube. URL: https://www.youtube.com/watch?v=Vr-0GKUmzo8\u0026t=2780s\u0026ab_channel=JPoint%2CJoker%D0%B8JUGru Armeria: A microservice framework well-suited everywhere. URL: https://speakerdeck.com/trustin/armeria-a-microservice-framework-well-suited-everywhere ","wordCount":"1563","inLanguage":"en","datePublished":"2023-08-15T13:49:50+05:30","dateModified":"2023-08-15T13:49:50+05:30","author":{"@type":"Person","name":"Nitin"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nitinsharmacs.github.io/tech/programming/scala/chat-app-in-scala-armeria/"},"publisher":{"@type":"Organization","name":"bitPhile","logo":{"@type":"ImageObject","url":"https://nitinsharmacs.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nitinsharmacs.github.io/ accesskey=h title="bitPhile (Alt + H)">bitPhile</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Chat App in Scala Armeria</h1><div class=post-meta>&lt;span title='2023-08-15 13:49:50 +0530 +0530'>August 15, 2023&lt;/span>&amp;nbsp;¬∑&amp;nbsp;Nitin</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#contents aria-label=Contents>Contents</a></li><li><a href=#abstract aria-label=Abstract>Abstract</a></li><li><a href=#what-is-armeria aria-label="What is Armeria?">What is Armeria?</a></li><li><a href=#about-poc aria-label="About PoC">About PoC</a><ul><li><a href=#prerequisites aria-label=Prerequisites>Prerequisites</a></li></ul></li><li><a href=#setting-up-the-project aria-label="Setting up the project">Setting up the project</a></li><li><a href=#create-a-service-handler-in-mainscala aria-label="Create a service handler in Main.scala">Create a service handler in <code>Main.scala</code></a></li><li><a href=#creating-message-endpoints aria-label="Creating message endpoints">Creating message endpoints</a></li><li><a href=#implementing-websocket-handler aria-label="Implementing Websocket handler">Implementing Websocket handler</a><ul><li><a href=#implementing-socket-on-ui aria-label="Implementing Socket on UI">Implementing Socket on UI</a></li><li><a href=#using-socket-wrapper-in-chat-component aria-label="Using Socket wrapper in Chat component">Using Socket wrapper in Chat component</a></li></ul></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li><li><a href=#acknowledgements aria-label=Acknowledgements>Acknowledgements</a></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><h2 id=contents>Contents<a hidden class=anchor aria-hidden=true href=#contents>#</a></h2><ol><li>Abstract</li><li>What is Armeria and its features?</li><li>Project details</li><li>Project setup requirements</li><li>Setting up Armeria and service handler</li><li>Setting up the web socket handler</li><li>Show example in the browser console</li><li>Socket service for frontend</li><li>Code snippet of the chat screen</li><li>Working example Screenshots etc</li><li>Conclusion</li><li>Acknowledgements</li><li>References</li></ol><h2 id=abstract>Abstract<a hidden class=anchor aria-hidden=true href=#abstract>#</a></h2><p>As a part of <a href=https://www.thoughtworks.com/en-in/clients/engineering-research>E4R</a> (Engineering for Research) retreat Hackathon, we explored Armeria and created a small PoC single group chat application using HTTP request polling and websockets. We are using the Armeria framework to develop one of the services in our project. So, it became the inspiration for the exploration.</p><p>This blog constitutes building a small chat application using REST API framework Armeria, Scala, and JavaScript. It won&rsquo;t have end-to-end code but only contains code snippets. You can find code on <a href=https://github.com/nitinsharmacs/chat-app-retreat>here</a>.</p><h2 id=what-is-armeria>What is Armeria?<a hidden class=anchor aria-hidden=true href=#what-is-armeria>#</a></h2><p>Armeria is a REST API microservice framework that becomes a backbone of powerful, fast, and asynchronous web services. It is completely asynchronous and built on top of reactive streams and Java 8 CompletableFuture. It is built in Java and compatible with any language that runs on JVM such as Scala, Kotlin, Clojure, etc.</p><p>It lets you develop services with technologies like gRPC, Thrift, HTTP, etc. running on the same application and port.</p><p>I think this introduction to Armeria would be enough to get a basic understanding. If you are more interested in Armeria&rsquo;s features, please have a look at its official website. Now let&rsquo;s see Armeria in action with the help of a small chat application.</p><h2 id=about-poc>About PoC<a hidden class=anchor aria-hidden=true href=#about-poc>#</a></h2><p>We are going to build a single group chat application comprising a backend service in Scala using the Armeria framework and a frontend service using React/Javascript.</p><h3 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h3><p>To get started with the project, we have to have some required prerequisites.</p><ol><li>Java 17 or more installed</li><li>Scala installed and <a href=https://www.scala-sbt.org/1.x/docs/>sbt</a></li><li>Node v17 or more</li><li>And an IDE of your choice.</li></ol><h2 id=setting-up-the-project>Setting up the project<a hidden class=anchor aria-hidden=true href=#setting-up-the-project>#</a></h2><p>Assuming all the prerequisites done, create a new project using sbt.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mkdir chat-app
</span></span><span style=display:flex><span>cd chat-app
</span></span><span style=display:flex><span>sbt
</span></span></code></pre></div><p>It setups the project. Now we need to create <code>build.sbt</code> and write the following inside it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#a6e22e>ThisBuild</span> <span style=color:#f92672>/</span> version <span style=color:#66d9ef>:</span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0.1.0-SNAPSHOT&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ThisBuild</span> <span style=color:#f92672>/</span> scalaVersion <span style=color:#66d9ef>:</span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;3.3.0&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>lazy</span> <span style=color:#66d9ef>val</span> root <span style=color:#66d9ef>=</span> <span style=color:#f92672>(</span>project in file<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;.&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>.</span>settings<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    name <span style=color:#66d9ef>:</span><span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;chat-app-retreat&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>    libraryDependencies <span style=color:#f92672>++=</span> <span style=color:#a6e22e>Seq</span><span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;com.linecorp.armeria&#34;</span> <span style=color:#f92672>%%</span> <span style=color:#e6db74>&#34;armeria-scala&#34;</span> <span style=color:#f92672>%</span> <span style=color:#e6db74>&#34;1.24.2&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;com.linecorp.armeria&#34;</span> <span style=color:#f92672>%</span> <span style=color:#e6db74>&#34;armeria-logback&#34;</span> <span style=color:#f92672>%</span> <span style=color:#e6db74>&#34;1.24.2&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;com.lihaoyi&#34;</span> <span style=color:#f92672>%%</span> <span style=color:#e6db74>&#34;upickle&#34;</span> <span style=color:#f92672>%</span> <span style=color:#e6db74>&#34;3.0.0&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Create <code>src</code> directory with the following basic structure.</p><pre tabindex=0><code>src
‚îú‚îÄ‚îÄ main
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ resources
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ scala
‚îî‚îÄ‚îÄ test
    ‚îî‚îÄ‚îÄ scala
</code></pre><p>Now reload the project using <code>sbt reload</code>.</p><h2 id=create-a-service-handler-in-mainscala>Create a service handler in <code>Main.scala</code><a hidden class=anchor aria-hidden=true href=#create-a-service-handler-in-mainscala>#</a></h2><p>Creating a simple server in Armeria is very simple as below code snippet shows. For now, we only have a single handler on path <code>"/"</code> that responds with <code>OK</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#66d9ef>object</span> <span style=color:#a6e22e>Main</span><span style=color:#66d9ef>:</span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>def</span> <span style=color:#66d9ef>main</span><span style=color:#f92672>(</span><span style=color:#66d9ef>args:</span> <span style=color:#66d9ef>Array</span><span style=color:#f92672>[</span><span style=color:#66d9ef>String</span><span style=color:#f92672>])</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Unit</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> port<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Int</span>      <span style=color:#f92672>=</span> <span style=color:#ae81ff>8000</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> server<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Server</span> <span style=color:#f92672>=</span> newServer<span style=color:#f92672>(</span>port<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> future         <span style=color:#66d9ef>=</span> server<span style=color:#f92672>.</span>start<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    future<span style=color:#f92672>.</span>join<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    logger<span style=color:#f92672>.</span>info<span style=color:#f92672>(</span><span style=color:#e6db74>s&#34;Server is running on port </span><span style=color:#e6db74>$port</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>def</span> newServer<span style=color:#f92672>(</span>port<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Int</span><span style=color:#f92672>)</span> <span style=color:#66d9ef>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> serverBuilder<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>ServerBuilder</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Server</span><span style=color:#f92672>.</span>builder<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    serverBuilder
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>http<span style=color:#f92672>(</span>port<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>service<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>(</span>ctx<span style=color:#f92672>,</span> req<span style=color:#f92672>)</span> <span style=color:#66d9ef>=&gt;</span> <span style=color:#a6e22e>HttpResponse</span><span style=color:#f92672>.</span>of<span style=color:#f92672>(</span><span style=color:#a6e22e>HttpStatus</span><span style=color:#f92672>.</span><span style=color:#a6e22e>OK</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>requestTimeout<span style=color:#f92672>(</span><span style=color:#a6e22e>Duration</span><span style=color:#f92672>.</span>ofSeconds<span style=color:#f92672>(</span><span style=color:#ae81ff>1000</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>build<span style=color:#f92672>()</span>
</span></span></code></pre></div><p>A handler or a service is attached to the server using <code>service</code> method. We can also have an annotated controller similar to Spring Boot that can be attached using <code>annotatedService</code> method.</p><p>Running this and sending request to our server, we get <code>200 OK</code>. Cool, our server works.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>‚ü© curl http://localhost:8000/
</span></span><span style=display:flex><span><span style=color:#ae81ff>200</span> OK‚èé
</span></span></code></pre></div><h2 id=creating-message-endpoints>Creating message endpoints<a hidden class=anchor aria-hidden=true href=#creating-message-endpoints>#</a></h2><p>We require to create two endpoints for creating and fetching all the messages.</p><ol><li><code>GET /e4r/message</code></li><li><code>POST /e4r/create-message</code></li></ol><p>Supposing we have a <code>ChatController</code> which handlers messages services. Adding it to server would like as shown below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>def</span> newServer<span style=color:#f92672>(</span>port<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Int</span><span style=color:#f92672>)</span> <span style=color:#66d9ef>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> serverBuilder<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>ServerBuilder</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Server</span><span style=color:#f92672>.</span>builder<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    serverBuilder
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>http<span style=color:#f92672>(</span>port<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>service<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>(</span>ctx<span style=color:#f92672>,</span> req<span style=color:#f92672>)</span> <span style=color:#66d9ef>=&gt;</span> <span style=color:#a6e22e>HttpResponse</span><span style=color:#f92672>.</span>of<span style=color:#f92672>(</span><span style=color:#a6e22e>HttpStatus</span><span style=color:#f92672>.</span><span style=color:#a6e22e>OK</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	  <span style=color:#f92672>.</span>annotatedService<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;/e4r&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ChatController</span><span style=color:#f92672>(</span><span style=color:#a6e22e>ChatService</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ChatRepository</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>requestTimeout<span style=color:#f92672>(</span><span style=color:#a6e22e>Duration</span><span style=color:#f92672>.</span>ofSeconds<span style=color:#f92672>(</span><span style=color:#ae81ff>1000</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>build<span style=color:#f92672>()</span>
</span></span></code></pre></div><p>Adding two handlers in <code>ChatController</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ChatController</span><span style=color:#f92672>(</span>chatService<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>ChatService</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>@Get</span><span style=color:#f92672>(</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#66d9ef>/message</span><span style=color:#960050;background-color:#1e0010>&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>def</span> <span style=color:#66d9ef>getMessages:</span> <span style=color:#66d9ef>HttpResponse</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> result <span style=color:#66d9ef>=</span> chatService<span style=color:#f92672>.</span>getMessages
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>HttpResponse</span><span style=color:#f92672>.</span>ofJson<span style=color:#f92672>(</span><span style=color:#a6e22e>HttpStatus</span><span style=color:#f92672>.</span><span style=color:#a6e22e>OK</span><span style=color:#f92672>,</span> messages<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>@Post</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/create-message&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>@RequestConverter</span><span style=color:#f92672>(</span>classOf<span style=color:#f92672>[</span><span style=color:#66d9ef>JacksonRequestConverterFunction</span><span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>def</span> createMessage<span style=color:#f92672>(</span>message<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>MessageDTO</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>HttpResponse</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    chatService
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>createMessage<span style=color:#f92672>(</span>message<span style=color:#f92672>.</span>toMessage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>HttpResponse</span><span style=color:#f92672>.</span>of<span style=color:#f92672>(</span><span style=color:#a6e22e>HttpStatus</span><span style=color:#f92672>.</span><span style=color:#a6e22e>CREATED</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Sending request on <code>/e4r/message</code> returns all the messages in group. <code>/e4r/create-message</code> creates a new message.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>‚ü© curl -X POST --header <span style=color:#e6db74>&#34;content-type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;sender&#34;:&#34;@atul&#34;, &#34;text&#34;: &#34;Hey there!&#34;, &#34;createdAt&#34;: &#34;2023-08-03T09:30:37.258Z&#34;}&#39;</span> http://localhost:8000/e4r/create-message
</span></span><span style=display:flex><span><span style=color:#ae81ff>201</span> Created
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>‚ü© curl -q http://localhost:8000/e4r/message | jq
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;d69f836c-eac7-48dc-9138-9d2d40b38f4c&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sender&#34;</span>: <span style=color:#e6db74>&#34;@atul&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;Hey there!&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;createdAt&#34;</span>: 1692114770.973873
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;50ca044a-0f2b-4904-902f-297946c30413&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sender&#34;</span>: <span style=color:#e6db74>&#34;@atul&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;Hey there!&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;createdAt&#34;</span>: 1691055037.258
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>]</span>
</span></span></code></pre></div><h2 id=implementing-websocket-handler>Implementing Websocket handler<a hidden class=anchor aria-hidden=true href=#implementing-websocket-handler>#</a></h2><p>To make the chat experiment real-time, we are required to use web sockets. Web socket is a protocol that creates a full duplex connection among devices. Want to deep dive into web sockets? You can have a read about it over <a href=https://datatracker.ietf.org/doc/html/rfc6455>this</a>.</p><p>Talking about Armeria, it has got web socket support in recent versions and that&rsquo;s why there is no rich documentation on it. However, we managed to get some implementation of web sockets by going through the code and tests.</p><p>Let&rsquo;s attach a socket service to our server.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>val</span> socketService <span style=color:#66d9ef>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>SocketService</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>socketService<span style=color:#f92672>.</span>on<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;new-message&#34;</span><span style=color:#f92672>,</span> <span style=color:#f92672>(</span>data<span style=color:#f92672>)</span> <span style=color:#66d9ef>=&gt;</span> println<span style=color:#f92672>(</span>data<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>socketService<span style=color:#f92672>.</span>on <span style=color:#f92672>{</span> <span style=color:#f92672>(</span>data<span style=color:#f92672>)</span> <span style=color:#66d9ef>=&gt;</span>
</span></span><span style=display:flex><span>    println<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;from broadcast&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    println<span style=color:#f92672>(</span>data<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>def</span> newServer<span style=color:#f92672>(</span>port<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Int</span><span style=color:#f92672>)</span> <span style=color:#66d9ef>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>val</span> serverBuilder<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>ServerBuilder</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Server</span><span style=color:#f92672>.</span>builder<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    serverBuilder
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>http<span style=color:#f92672>(</span>port<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>service<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;/&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>(</span>ctx<span style=color:#f92672>,</span> req<span style=color:#f92672>)</span> <span style=color:#66d9ef>=&gt;</span> <span style=color:#a6e22e>HttpResponse</span><span style=color:#f92672>.</span>of<span style=color:#f92672>(</span><span style=color:#a6e22e>HttpStatus</span><span style=color:#f92672>.</span><span style=color:#a6e22e>OK</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>service<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;/chat/:clientId&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>WebSocketService</span><span style=color:#f92672>.</span>builder<span style=color:#f92672>(</span>socketService<span style=color:#f92672>).</span>allowedOrigins<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;*&#34;</span><span style=color:#f92672>).</span>build<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	  <span style=color:#f92672>.</span>annotatedService<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;/e4r&#34;</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ChatController</span><span style=color:#f92672>(</span><span style=color:#a6e22e>ChatService</span><span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ChatRepository</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>requestTimeout<span style=color:#f92672>(</span><span style=color:#a6e22e>Duration</span><span style=color:#f92672>.</span>ofSeconds<span style=color:#f92672>(</span><span style=color:#ae81ff>1000</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>build<span style=color:#f92672>()</span>
</span></span></code></pre></div><p><code>WebSocketService</code> builder takes <code>socketService</code> and builds a websocket handler. Method <code>allowOrigins</code> let&rsquo;s it accept connection from any origin.</p><p>Following code snippet shows <code>SocketService</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SocketService</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>WebSocketServiceHandler</span><span style=color:#66d9ef>:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>def</span> <span style=color:#66d9ef>handle</span><span style=color:#f92672>(</span><span style=color:#66d9ef>ctx:</span> <span style=color:#66d9ef>ServiceRequestContext</span><span style=color:#f92672>,</span> <span style=color:#66d9ef>in:</span> <span style=color:#66d9ef>WebSocket</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>WebSocket</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>val</span> writer<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>WebSocketWriter</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>WebSocket</span><span style=color:#f92672>.</span>streaming<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    in<span style=color:#f92672>.</span>subscribe<span style=color:#f92672>(</span><span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Subscriber</span><span style=color:#f92672>[</span><span style=color:#66d9ef>WebSocketFrame</span><span style=color:#f92672>]</span><span style=color:#66d9ef>:</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>def</span> <span style=color:#66d9ef>onSubscribe</span><span style=color:#f92672>(</span><span style=color:#66d9ef>s:</span> <span style=color:#66d9ef>Subscription</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Unit</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>        s<span style=color:#f92672>.</span>request<span style=color:#f92672>(</span><span style=color:#a6e22e>Long</span><span style=color:#f92672>.</span><span style=color:#a6e22e>MaxValue</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>def</span> onNext<span style=color:#f92672>(</span>webSocketFrame<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>WebSocketFrame</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Unit</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>val</span> frame <span style=color:#66d9ef>=</span> webSocketFrame
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>try</span>
</span></span><span style=display:flex><span>            frame<span style=color:#f92672>.</span>`type` <span style=color:#66d9ef>match</span>
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>WebSocketFrameType</span><span style=color:#f92672>.</span><span style=color:#a6e22e>TEXT</span> <span style=color:#66d9ef>=&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#75715e>// call handlers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>				getAllHanders<span style=color:#f92672>.</span>foreach<span style=color:#f92672>((</span>cb<span style=color:#f92672>)</span> <span style=color:#66d9ef>=&gt;</span> cb<span style=color:#f92672>(</span>frame<span style=color:#f92672>.</span>text<span style=color:#f92672>()))</span>
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>WebSocketFrameType</span><span style=color:#f92672>.</span><span style=color:#a6e22e>CLOSE</span> <span style=color:#66d9ef>=&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>val</span> closeFrame <span style=color:#66d9ef>=</span> frame<span style=color:#f92672>.</span>asInstanceOf<span style=color:#f92672>[</span><span style=color:#66d9ef>CloseWebSocketFrame</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>                writer<span style=color:#f92672>.</span>close<span style=color:#f92672>(</span>closeFrame<span style=color:#f92672>.</span>status<span style=color:#f92672>,</span> closeFrame<span style=color:#f92672>.</span>reasonPhrase<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>case</span> <span style=color:#66d9ef>_</span> <span style=color:#66d9ef>=&gt;</span>
</span></span><span style=display:flex><span>              <span style=color:#75715e>// do nothing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>catch</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> jsonException<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>ujson.ParseException</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>              println<span style=color:#f92672>(</span>jsonException<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> t<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Throwable</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>              writer<span style=color:#f92672>.</span>close<span style=color:#f92672>(</span>t<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>finally</span> println<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;finally&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>catch</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>case</span> t<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Throwable</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>            println<span style=color:#f92672>(</span>t<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>def</span> onError<span style=color:#f92672>(</span>t<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Throwable</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Unit</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>        writer<span style=color:#f92672>.</span>close<span style=color:#f92672>(</span>t<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>def</span> onComplete<span style=color:#f92672>()</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Unit</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>        println<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;CLOSED&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        writer<span style=color:#f92672>.</span>close
</span></span><span style=display:flex><span>    <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    writer
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>def</span> emit<span style=color:#f92672>(</span>namespace<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>String</span><span style=color:#f92672>,</span> data<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>String</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>Unit</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span>socketWriters<span style=color:#f92672>.</span>values<span style=color:#f92672>.</span>foreach<span style=color:#f92672>((</span>writer<span style=color:#f92672>)</span> <span style=color:#66d9ef>=&gt;</span>
</span></span><span style=display:flex><span>      writer<span style=color:#f92672>.</span>write<span style=color:#f92672>(</span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span>createPayload<span style=color:#f92672>(</span>namespace<span style=color:#f92672>,</span> data<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;namespaced&#34;</span><span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>)</span>
</span></span></code></pre></div><p><code>SocketService</code> extends <code>WebSocketServiceHandler</code>. The important method to implement is <code>handle</code> which triggers every time any client connects with the server.</p><p>Armeria implements Websocket using reactive streams. So, a subscriber is attached to the web socket reactive stream <code>in</code> on every new connection. The <code>writer</code> stream is used to write data to the connected client socket.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span>writer<span style=color:#f92672>.</span>write<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Hello world&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p><code>emit</code> is the method that takes a <code>namespace</code> and <code>data</code>. Any handler on the client side listening on this namespace will get that <code>data</code>.</p><p>So, whenever a new message is created, all the connected clients have to be notified about the message. This can be accomplished using,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scala data-lang=scala><span style=display:flex><span>  <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ChatController</span><span style=color:#f92672>(</span>chatService<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>ChatService</span><span style=color:#f92672>,</span> socket<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>SocketService</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>@Post</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/create-message&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>@RequestConverter</span><span style=color:#f92672>(</span>classOf<span style=color:#f92672>[</span><span style=color:#66d9ef>JacksonRequestConverterFunction</span><span style=color:#f92672>])</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>def</span> createMessage<span style=color:#f92672>(</span>message<span style=color:#66d9ef>:</span> <span style=color:#66d9ef>MessageDTO</span><span style=color:#f92672>)</span><span style=color:#66d9ef>:</span> <span style=color:#66d9ef>HttpResponse</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>	socket<span style=color:#f92672>.</span>emit<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;new-message&#34;</span><span style=color:#f92672>,</span> message<span style=color:#f92672>.</span>toJson<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    chatService
</span></span><span style=display:flex><span>      <span style=color:#f92672>.</span>createMessage<span style=color:#f92672>(</span>message<span style=color:#f92672>.</span>toMessage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>HttpResponse</span><span style=color:#f92672>.</span>of<span style=color:#f92672>(</span><span style=color:#a6e22e>HttpStatus</span><span style=color:#f92672>.</span><span style=color:#a6e22e>CREATED</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p><code>new-message</code> is namespace and <code>message.toJson</code> is data.</p><p>Let&rsquo;s try creating a message and see if we get new message on client socket.</p><p><img loading=lazy src=/tech/programming/scala/create-socket-web-console.png alt="Create websocket connection"></p><p>So, the client is connected to the server. Creating a new message triggers a <code>message</code> event on client socket. The below picture shows the message it got from the server.</p><p><img loading=lazy src=/tech/programming/scala/send-message-in-web-console.png alt="Sending the message"></p><p>Our simple chat application (without any UI üòÇ) is working.</p><h3 id=implementing-socket-on-ui>Implementing Socket on UI<a hidden class=anchor aria-hidden=true href=#implementing-socket-on-ui>#</a></h3><p>Similar to backend, we have written a wrapper on top of WebSocket. This simplistic wrapper manages namespaces and invokes handlers listening on respective namespaces.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>type</span> <span style=color:#a6e22e>fn</span> <span style=color:#f92672>=</span> { (<span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ChatSocket</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>handlers</span><span style=color:#f92672>:</span> { [<span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>]<span style=color:#f92672>:</span> <span style=color:#a6e22e>fn</span>[] };
</span></span><span style=display:flex><span>  <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>connect</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>socket</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>WebSocket</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>url</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>`/</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>username</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>socket</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;open&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;socket connected&#39;</span>);
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>socket</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;message&#39;</span>, (<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>MessageEvent</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>namespace</span>, <span style=color:#a6e22e>data</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>handlers</span>[<span style=color:#a6e22e>namespace</span>].<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>cb</span>) =&gt; <span style=color:#a6e22e>cb</span>(<span style=color:#a6e22e>data</span>));
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>socket</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;close&#39;</span>, (<span style=color:#a6e22e>event</span>) =&gt;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Closed&#39;</span>, <span style=color:#a6e22e>event</span>)
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>To register a handler, wrapper implements an <code>on</code> method.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ChatSocket</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>on</span>(<span style=color:#a6e22e>namespace</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>cb</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>fn</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handlers</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>handlers</span>[<span style=color:#a6e22e>namespace</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>handlers</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>handlers</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>cb</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>handlers</span>[<span style=color:#a6e22e>namespace</span>] <span style=color:#f92672>=</span> [<span style=color:#a6e22e>cb</span>];
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><h3 id=using-socket-wrapper-in-chat-component>Using Socket wrapper in Chat component<a hidden class=anchor aria-hidden=true href=#using-socket-wrapper-in-chat-component>#</a></h3><p>As of now, we are only listening on new messages. We are not sending messages using socket. Messages are created using HTTP REST request only.</p><p>Following shows usages of socket wrapper in a chat component.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Chats</span> <span style=color:#f92672>=</span> ({ <span style=color:#a6e22e>chatService</span>, <span style=color:#a6e22e>username</span> }<span style=color:#f92672>:</span> <span style=color:#a6e22e>ChatAppProps</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>useEffect</span>(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>chatSocket</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ChatSocket</span>(
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;ws://localhost:8000/chat&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>username</span>
</span></span><span style=display:flex><span>    ).<span style=color:#a6e22e>connect</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>chatSocket</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;new-message&#39;</span>, (<span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Message</span>) =&gt;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>setMessages</span>((<span style=color:#a6e22e>prevMessages</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Message</span>[]) =&gt; [...<span style=color:#a6e22e>prevMessages</span>, <span style=color:#a6e22e>message</span>])
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }, []);
</span></span><span style=display:flex><span>  <span style=color:#75715e>//...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span></code></pre></div><p><code>useEffect</code> hook initialises the socket and socket starts listening on <code>new-message</code> namespace. Whenever a new message comes, <code>setMessages</code> updates the messages state and the component updates.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Armeria is a newly developed framework which is currently in development. It provides several powerful features such as allowing to run different services within a single application and on the same port. It also provides asynchronous execution out of the box. So, it can handle multiple requests without us implementing concurrency and get our hands dirty in threads and concurrency. If you are looking for a lightweight, fast, asynchronous, and ready-to-use REST API framework, it is a good choice to go with.</p><p>However, being a new framework, the documentation is undeveloped. We tried to find the implementation of web sockets by going inside the tests they&rsquo;ve created.</p><h2 id=acknowledgements>Acknowledgements<a hidden class=anchor aria-hidden=true href=#acknowledgements>#</a></h2><p>We would like to thank Satya and the Retreat team for organising such an interesting Retreat. Thanks to all the team members (<a href=https://github.com/i-am-chauhan>Shubham Chauhan</a> and <a href=https://github.com/Atul-Chaudhari>Atul</a>) who have chosen this trivial problem statement to explore.</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ol><li><em>Armeria Official Docs</em>. URL: <a href=https://armeria.dev/docs/>https://armeria.dev/docs/</a></li><li><em>Armeria Github Repo.</em> URL: <a href=https://github.com/line/armeria>https://github.com/line/armeria</a></li><li><em>Trustin Lee ‚Äî Armeria: A microservice framework well-suited everywhere</em>. Youtube. URL: <a href="https://www.youtube.com/watch?v=Vr-0GKUmzo8&amp;t=2780s&amp;ab_channel=JPoint%2CJoker%D0%B8JUGru">https://www.youtube.com/watch?v=Vr-0GKUmzo8&amp;t=2780s&amp;ab_channel=JPoint%2CJoker%D0%B8JUGru</a></li><li><em>Armeria: A microservice framework well-suited everywhere</em>. URL: <a href=https://speakerdeck.com/trustin/armeria-a-microservice-framework-well-suited-everywhere>https://speakerdeck.com/trustin/armeria-a-microservice-framework-well-suited-everywhere</a></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://nitinsharmacs.github.io/tags/rest-api/>Rest-Api</a></li><li><a href=https://nitinsharmacs.github.io/tags/microservices/>Microservices</a></li><li><a href=https://nitinsharmacs.github.io/tags/armeria/>Armeria</a></li><li><a href=https://nitinsharmacs.github.io/tags/websocket/>Websocket</a></li><li><a href=https://nitinsharmacs.github.io/tags/socket/>Socket</a></li></ul></footer><div id=commentor></div><script>const embedCommentorJs=()=>new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("defer",!0),n.src="/commentor/commentor.js",n.onload=e,n.onerror=t,document.head.appendChild(n)}),embedCommentorStyles=()=>new Promise((e,t)=>{const n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.href="/commentor/commentor.css",n.onload=e,n.onerror=t,document.head.appendChild(n)}),getPageId=()=>window.location.href.split("/").slice(-2).join("");embedCommentorJs().then(()=>embedCommentorStyles()).then(()=>{Commentor&&Commentor.init("Comments",getPageId())}).catch(e=>console.error("Commentor not loaded",e))</script></article></main><footer class=footer><span>&copy; 2024 <a href=https://nitinsharmacs.github.io/>bitPhile</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>